#include <stdio.h>
#include <string.h>
#include <stdlib.h>


#define MPEG_ES

#define POS     0
#define SIZE    1

const unsigned int frame_info[][2] = {
#if defined (H264_ES)
/*  position     size */
{   0   ,   26978   ,   },
{   26978   ,   849 ,   },
{   27827   ,   641 ,   },
{   28468   ,   810 ,   },
{   29278   ,   804 ,   },
{   30082   ,   1466    ,   },
{   31548   ,   993 ,   },
{   32541   ,   989 ,   },
{   33530   ,   2224    ,   },
{   35754   ,   975 ,   },
{   36729   ,   1685    ,   },
{   38414   ,   943 ,   },
{   39357   ,   941 ,   },
{   40298   ,   1056    ,   },
{   41354   ,   966 ,   },
{   42320   ,   1633    ,   },
{   43953   ,   1398    ,   },
{   45351   ,   1948    ,   },
{   47299   ,   2125    ,   },
{   49424   ,   1445    ,   },
{   50869   ,   4336    ,   },
{   55205   ,   3760    ,   },
{   58965   ,   4187    ,   },
{   63152   ,   3384    ,   },
{   66536   ,   2150    ,   },
{   68686   ,   38035   ,   },
{   106721  ,   1637    ,   },
{   108358  ,   1090    ,   },
{   109448  ,   1401    ,   },
{   110849  ,   1358    ,   },
{   112207  ,   1691    ,   },
{   113898  ,   1085    ,   },
{   114983  ,   1118    ,   },
{   116101  ,   1457    ,   },
{   117558  ,   1352    ,   },
{   118910  ,   1644    ,   },
{   120554  ,   1570    ,   },
{   122124  ,   1660    ,   },
{   123784  ,   2193    ,   },
{   125977  ,   2148    ,   },
{   128125  ,   2801    ,   },
{   130926  ,   2587    ,   },
{   133513  ,   3984    ,   },
{   137497  ,   3711    ,   },
{   141208  ,   3657    ,   },
{   144865  ,   2930    ,   },
{   147795  ,   3052    ,   },
{   150847  ,   2720    ,   },
{   153567  ,   3107    ,   },
{   156674  ,   2940    ,   },
{   159614  ,   44363   ,   },
{   203977  ,   1827    ,   },
{   205804  ,   1223    ,   },
{   207027  ,   1407    ,   },
{   208434  ,   1558    ,   },
{   209992  ,   1480    ,   },
{   211472  ,   1166    ,   },
{   212638  ,   1375    ,   },
{   214013  ,   1790    ,   },
{   215803  ,   1591    ,   },
{   217394  ,   2181    ,   },
{   219575  ,   1667    ,   },
{   221242  ,   1615    ,   },
{   222857  ,   1780    ,   },
{   224637  ,   1699    ,   },
{   226336  ,   2015    ,   },
{   228351  ,   1889    ,   },
{   230240  ,   2193    ,   },
{   232433  ,   2379    ,   },
{   234812  ,   1937    ,   },
{   236749  ,   2765    ,   },
{   239514  ,   2821    ,   },
{   242335  ,   3131    ,   },
{   245466  ,   3227    ,   },
{   248693  ,   3189    ,   },
{   251882  ,   46131   ,   },
{   298013  ,   2248    ,   },
{   300261  ,   1304    ,   },
{   301565  ,   1616    ,   },
{   303181  ,   1588    ,   },
{   304769  ,   2210    ,   },
{   306979  ,   1215    ,   },
{   308194  ,   1494    ,   },
{   309688  ,   1861    ,   },
{   311549  ,   1762    ,   },
{   313311  ,   1943    ,   },
{   315254  ,   1691    ,   },
{   316945  ,   1580    ,   },
{   318525  ,   1990    ,   },
{   320515  ,   1816    ,   },
{   322331  ,   2571    ,   },
{   324902  ,   2208    ,   },
{   327110  ,   2160    ,   },
{   329270  ,   2409    ,   },
{   331679  ,   2020    ,   },
{   333699  ,   2780    ,   },
{   336479  ,   2607    ,   },
{   339086  ,   2751    ,   },
{   341837  ,   3232    ,   },
{   345069  ,   3367    ,   },
{   348436  ,   46655   ,   },
{   395091  ,   1983    ,   },
{   397074  ,   1429    ,   },
{   398503  ,   1539    ,   },
{   400042  ,   1522    ,   },
{   401564  ,   1808    ,   },
{   403372  ,   1278    ,   },
{   404650  ,   1668    ,   },
{   406318  ,   2187    ,   },
{   408505  ,   1847    ,   },
{   410352  ,   2381    ,   },
{   412733  ,   1760    ,   },
{   414493  ,   1832    ,   },
{   416325  ,   2101    ,   },
{   418426  ,   1948    ,   },
{   420374  ,   2422    ,   },
{   422796  ,   2374    ,   },
{   425170  ,   2504    ,   },
{   427674  ,   2673    ,   },
{   430347  ,   2268    ,   },
{   432615  ,   3376    ,   },
{   435991  ,   2930    ,   },
{   438921  ,   3069    ,   },
{   441990  ,   3565    ,   },
{   445555  ,   3727    ,   },
{   449282  ,   50414   ,   },
{   499696  ,   1891    ,   },
{   501587  ,   1362    ,   },
{   502949  ,   1599    ,   },
{   504548  ,   1659    ,   },
{   506207  ,   2117    ,   },
{   508324  ,   1233    ,   },
{   509557  ,   1525    ,   },
{   511082  ,   1865    ,   },
{   512947  ,   1850    ,   },
{   514797  ,   2085    ,   },
{   516882  ,   1700    ,   },
{   518582  ,   1750    ,   },
{   520332  ,   2192    ,   },
{   522524  ,   2078    ,   },
{   524602  ,   2722    ,   },
{   527324  ,   2382    ,   },
{   529706  ,   2488    ,   },
{   532194  ,   2679    ,   },
{   534873  ,   2225    ,   },
{   537098  ,   3079    ,   },
{   540177  ,   2801    ,   },
{   542978  ,   3039    ,   },
{   546017  ,   3572    ,   },
{   549589  ,   3483    ,   },
{   553072  ,   49915   ,   },
{   602987  ,   1850    ,   },
{   604837  ,   1408    ,   },
{   606245  ,   1606    ,   },
{   607851  ,   1552    ,   },
{   609403  ,   1847    ,   },
{   611250  ,   1251    ,   },
{   612501  ,   1583    ,   },
{   614084  ,   2139    ,   },
{   616223  ,   1956    ,   },
{   618179  ,   2615    ,   },
{   620794  ,   1903    ,   },
{   622697  ,   1950    ,   },
{   624647  ,   2261    ,   },
{   626908  ,   2031    ,   },
{   628939  ,   2631    ,   },
{   631570  ,   2447    ,   },
{   634017  ,   2529    ,   },
{   636546  ,   2935    ,   },
{   639481  ,   2474    ,   },
{   641955  ,   3353    ,   },
{   645308  ,   3069    ,   },
{   648377  ,   3300    ,   },
{   651677  ,   3938    ,   },
{   655615  ,   3789    ,   },
{   659404  ,   50490   ,   },
{   709894  ,   1831    ,   },
{   711725  ,   1473    ,   },
{   713198  ,   1657    ,   },
{   714855  ,   1582    ,   },
{   716437  ,   2385    ,   },
{   718822  ,   1230    ,   },
{   720052  ,   1499    ,   },
{   721551  ,   1986    ,   },
{   723537  ,   1711    ,   },
{   725248  ,   2034    ,   },
{   727282  ,   1662    ,   },
{   728944  ,   1676    ,   },
{   730620  ,   2299    ,   },
{   732919  ,   2087    ,   },
{   735006  ,   2966    ,   },
{   737972  ,   2379    ,   },
{   740351  ,   2591    ,   },
{   742942  ,   2765    ,   },
{   745707  ,   2210    ,   },
{   747917  ,   3170    ,   },
{   751087  ,   3125    ,   },
{   754212  ,   3150    ,   },
{   757362  ,   3930    ,   },
{   761292  ,   3630    ,   },
{   764922  ,   50494   ,   },
{   815416  ,   1787    ,   },
{   817203  ,   1471    ,   },
{   818674  ,   1639    ,   },
{   820313  ,   1630    ,   },
{   821943  ,   1815    ,   },
{   823758  ,   1266    ,   },
{   825024  ,   1633    ,   },
{   826657  ,   2151    ,   },
{   828808  ,   1913    ,   },
{   830721  ,   2357    ,   },
{   833078  ,   1823    ,   },
{   834901  ,   1925    ,   },
{   836826  ,   2306    ,   },
{   839132  ,   2132    ,   },
{   841264  ,   2586    ,   },
{   843850  ,   2400    ,   },
{   846250  ,   2718    ,   },
{   848968  ,   3004    ,   },
{   851972  ,   2431    ,   },
{   854403  ,   3729    ,   },
{   858132  ,   3287    ,   },
{   861419  ,   3480    ,   },
{   864899  ,   4004    ,   },
{   868903  ,   3879    ,   },
{   872782  ,   50280   ,   },
{   923062  ,   2597    ,   },
{   925659  ,   1497    ,   },
{   927156  ,   1740    ,   },
{   928896  ,   1735    ,   },
{   930631  ,   2155    ,   },
{   932786  ,   1202    ,   },
{   933988  ,   1369    ,   },
{   935357  ,   1948    ,   },
{   937305  ,   1685    ,   },
{   938990  ,   2005    ,   },
{   940995  ,   1705    ,   },
{   942700  ,   1717    ,   },
{   944417  ,   2289    ,   },
{   946706  ,   2030    ,   },
{   948736  ,   2889    ,   },
{   951625  ,   2380    ,   },
{   954005  ,   2525    ,   },
{   956530  ,   2933    ,   },
{   959463  ,   2375    ,   },
{   961838  ,   3192    ,   },
{   965030  ,   3173    ,   },
{   968203  ,   3351    ,   },
{   971554  ,   3960    ,   },
{   975514  ,   3854    ,   },
{   979368  ,   47676   ,   },
{   1027044 ,   2556    ,   },
{   1029600 ,   1612    ,   },
{   1031212 ,   1709    ,   },
{   1032921 ,   1607    ,   },
{   1034528 ,   1821    ,   },
{   1036349 ,   1286    ,   },
{   1037635 ,   1532    ,   },
{   1039167 ,   2139    ,   },
{   1041306 ,   1801    ,   },
{   1043107 ,   2610    ,   },
{   1045717 ,   1854    ,   },
{   1047571 ,   1908    ,   },
{   1049479 ,   2245    ,   },
{   1051724 ,   2127    ,   },
{   1053851 ,   2651    ,   },
{   1056502 ,   2484    ,   },
{   1058986 ,   2611    ,   },
{   1061597 ,   3000    ,   },
{   1064597 ,   2449    ,   },
{   1067046 ,   3455    ,   },
{   1070501 ,   3218    ,   },
{   1073719 ,   3439    ,   },
{   1077158 ,   3963    ,   },
{   1081121 ,   4089    ,   },
{   1085210 ,   47149   ,   },
{   1132359 ,   2884    ,   },
{   1135243 ,   1631    ,   },
{   1136874 ,   1790    ,   },
{   1138664 ,   1748    ,   },
{   1140412 ,   2505    ,   },
{   1142917 ,   1221    ,   },
{   1144138 ,   1382    ,   },
{   1145520 ,   1767    ,   },
{   1147287 ,   1614    ,   },
{   1148901 ,   1981    ,   },
{   1150882 ,   1690    ,   },
{   1152572 ,   1773    ,   },
{   1154345 ,   2294    ,   },
{   1156639 ,   2056    ,   },
{   1158695 ,   2969    ,   },
{   1161664 ,   2405    ,   },
{   1164069 ,   2639    ,   },
{   1166708 ,   2908    ,   },
{   1169616 ,   2455    ,   },
{   1172071 ,   3312    ,   },
{   1175383 ,   3213    ,   },
{   1178596 ,   3431    ,   },
{   1182027 ,   3970    ,   },
{   1185997 ,   3895    ,   },
{   1189892 ,   46767   ,   },
{   1236659 ,   2626    ,   },
{   1239285 ,   1655    ,   },
{   1240940 ,   1770    ,   },
{   1242710 ,   1658    ,   },
{   1244368 ,   1949    ,   },
{   1246317 ,   1310    ,   },
{   1247627 ,   1531    ,   },
{   1249158 ,   2106    ,   },
{   1251264 ,   1804    ,   },
{   1253068 ,   2311    ,   },
{   1255379 ,   1905    ,   },
{   1257284 ,   1932    ,   },
{   1259216 ,   2293    ,   },
{   1261509 ,   2170    ,   },
{   1263679 ,   2765    ,   },
{   1266444 ,   2512    ,   },
{   1268956 ,   2654    ,   },
{   1271610 ,   3031    ,   },
{   1274641 ,   2582    ,   },
{   1277223 ,   3714    ,   },
{   1280937 ,   3339    ,   },
{   1284276 ,   3554    ,   },
{   1287830 ,   4139    ,   },
{   1291969 ,   4144    ,   },
{   1296113 ,   47784   ,   },
{   1343897 ,   2973    ,   },
{   1346870 ,   1634    ,   },
{   1348504 ,   1802    ,   },
{   1350306 ,   1716    ,   },
{   1352022 ,   2231    ,   },
{   1354253 ,   1213    ,   },
{   1355466 ,   1453    ,   },
{   1356919 ,   1829    ,   },
{   1358748 ,   1694    ,   },
{   1360442 ,   2016    ,   },
{   1362458 ,   1802    ,   },
{   1364260 ,   1754    ,   },
{   1366014 ,   2305    ,   },
{   1368319 ,   2059    ,   },
{   1370378 ,   2978    ,   },
{   1373356 ,   2438    ,   },
{   1375794 ,   2685    ,   },
{   1378479 ,   2926    ,   },
{   1381405 ,   2383    ,   },
{   1383788 ,   3281    ,   },
{   1387069 ,   3244    ,   },
{   1390313 ,   3446    ,   },
{   1393759 ,   3977    ,   },
{   1397736 ,   3898    ,   },
{   1401634 ,   46521   ,   },
{   1448155 ,   2572    ,   },
{   1450727 ,   1645    ,   },
{   1452372 ,   1784    ,   },
{   1454156 ,   1676    ,   },
{   1455832 ,   1907    ,   },
{   1457739 ,   1348    ,   },
{   1459087 ,   1550    ,   },
{   1460637 ,   2101    ,   },
{   1462738 ,   1806    ,   },
{   1464544 ,   2607    ,   },
{   1467151 ,   1908    ,   },
{   1469059 ,   1980    ,   },
{   1471039 ,   2395    ,   },
{   1473434 ,   2193    ,   },
{   1475627 ,   2814    ,   },
{   1478441 ,   2543    ,   },
{   1480984 ,   2750    ,   },
{   1483734 ,   3076    ,   },
{   1486810 ,   2566    ,   },
{   1489376 ,   3659    ,   },
{   1493035 ,   3270    ,   },
{   1496305 ,   3679    ,   },
{   1499984 ,   4145    ,   },
{   1504129 ,   4213    ,   },
{   1508342 ,   47500   ,   },
{   1555842 ,   2953    ,   },
{   1558795 ,   1621    ,   },
{   1560416 ,   1795    ,   },
{   1562211 ,   1672    ,   },
{   1563883 ,   2469    ,   },
{   1566352 ,   1241    ,   },
{   1567593 ,   1434    ,   },
{   1569027 ,   1840    ,   },
{   1570867 ,   1738    ,   },
{   1572605 ,   2081    ,   },
{   1574686 ,   1769    ,   },
{   1576455 ,   1772    ,   },
{   1578227 ,   2305    ,   },
{   1580532 ,   2139    ,   },
{   1582671 ,   3081    ,   },
{   1585752 ,   2425    ,   },
{   1588177 ,   2702    ,   },
{   1590879 ,   2940    ,   },
{   1593819 ,   2376    ,   },
{   1596195 ,   3007    ,   },
{   1599202 ,   3204    ,   },
{   1602406 ,   3444    ,   },
{   1605850 ,   4157    ,   },
{   1610007 ,   3739    ,   },
{   1613746 ,   45168   ,   },
{   1658914 ,   2878    ,   },
{   1661792 ,   1531    ,   },
{   1663323 ,   1703    ,   },
{   1665026 ,   1507    ,   },
{   1666533 ,   1936    ,   },
{   1668469 ,   1397    ,   },
{   1669866 ,   1614    ,   },
{   1671480 ,   2118    ,   },
{   1673598 ,   1864    ,   },
{   1675462 ,   2409    ,   },
{   1677871 ,   1923    ,   },
{   1679794 ,   2014    ,   },
{   1681808 ,   2399    ,   },
{   1684207 ,   2262    ,   },
{   1686469 ,   2782    ,   },
{   1689251 ,   2614    ,   },
{   1691865 ,   2768    ,   },
{   1694633 ,   3083    ,   },
{   1697716 ,   2497    ,   },
{   1700213 ,   3796    ,   },
{   1704009 ,   3344    ,   },
{   1707353 ,   3633    ,   },
{   1710986 ,   4137    ,   },
{   1715123 ,   4046    ,   },
{   1719169 ,   47074   ,   },
{   1766243 ,   3059    ,   },
{   1769302 ,   1607    ,   },
{   1770909 ,   1813    ,   },
{   1772722 ,   1548    ,   },
{   1774270 ,   2101    ,   },
{   1776371 ,   1194    ,   },
{   1777565 ,   1444    ,   },
{   1779009 ,   1887    ,   },
{   1780896 ,   1726    ,   },
{   1782622 ,   2007    ,   },
{   1784629 ,   1719    ,   },
{   1786348 ,   1759    ,   },
{   1788107 ,   2349    ,   },
{   1790456 ,   2156    ,   },
{   1792612 ,   2942    ,   },
{   1795554 ,   2477    ,   },
{   1798031 ,   2391    ,   },
{   1800422 ,   2814    ,   },
{   1803236 ,   2142    ,   },
{   1805378 ,   2990    ,   },
{   1808368 ,   2952    ,   },
{   1811320 ,   3045    ,   },
{   1814365 ,   3879    ,   },
{   1818244 ,   3413    ,   },
{   1821657 ,   44697   ,   },
{   1866354 ,   2526    ,   },
{   1868880 ,   1430    ,   },
{   1870310 ,   1600    ,   },
{   1871910 ,   1375    ,   },
{   1873285 ,   1843    ,   },
{   1875128 ,   1386    ,   },
{   1876514 ,   1571    ,   },
{   1878085 ,   2255    ,   },
{   1880340 ,   1778    ,   },
{   1882118 ,   2702    ,   },
{   1884820 ,   1744    ,   },
{   1886564 ,   1843    ,   },
{   1888407 ,   2275    ,   },
{   1890682 ,   1990    ,   },
{   1892672 ,   2577    ,   },
{   1895249 ,   2479    ,   },
{   1897728 ,   2487    ,   },
{   1900215 ,   2956    ,   },
{   1903171 ,   2296    ,   },
{   1905467 ,   3467    ,   },
{   1908934 ,   3241    ,   },
{   1912175 ,   3379    ,   },
{   1915554 ,   4120    ,   },
{   1919674 ,   3896    ,   },
{   1923570 ,   46157   ,   },
{   1969727 ,   3020    ,   },
{   1972747 ,   1466    ,   },
{   1974213 ,   1654    ,   },
{   1975867 ,   1370    ,   },
{   1977237 ,   2196    ,   },
{   1979433 ,   1284    ,   },
{   1980717 ,   1353    ,   },
{   1982070 ,   1849    ,   },
{   1983919 ,   1605    ,   },
{   1985524 ,   2074    ,   },
{   1987598 ,   1518    ,   },
{   1989116 ,   1653    ,   },
{   1990769 ,   2222    ,   },
{   1992991 ,   1967    ,   },
{   1994958 ,   3020    ,   },
{   1997978 ,   2160    ,   },
{   2000138 ,   2425    ,   },
{   2002563 ,   2580    ,   },
{   2005143 ,   1986    ,   },
{   2007129 ,   2778    ,   },
{   2009907 ,   2555    ,   },
{   2012462 ,   2703    ,   },
{   2015165 ,   3605    ,   },
{   2018770 ,   3124    ,   },

#elif defined (MPEG_ES)
/*  position     size */
{   0   ,   78047   },
{   78047   ,   23327   },
{   101374  ,   6092    },
{   107466  ,   6176    },
{   113642  ,   23512   },
{   137154  ,   6512    },
{   143666  ,   6309    },
{   149975  ,   24964   },
{   174939  ,   7082    },
{   182021  ,   6031    },
{   188052  ,   25914   },
{   213966  ,   6417    },
{   220383  ,   6668    },
{   227051  ,   26362   },
{   253413  ,   6442    },
{   259855  ,   6285    },
{   266140  ,   85806   },
{   351946  ,   7706    },
{   359652  ,   6327    },
{   365979  ,   26936   },
{   392915  ,   6922    },
{   399837  ,   6335    },
{   406172  ,   27528   },
{   433700  ,   6696    },
{   440396  ,   6750    },
{   447146  ,   25133   },
{   472279  ,   6641    },
{   478920  ,   6605    },
{   485525  ,   25143   },
{   510668  ,   6780    },
{   517448  ,   6627    },
{   524075  ,   28686   },
{   552761  ,   7109    },
{   559870  ,   6409    },
{   566279  ,   81869   },
{   648148  ,   7307    },
{   655455  ,   6769    },
{   662224  ,   25616   },
{   687840  ,   6717    },
{   694557  ,   6660    },
{   701217  ,   26087   },
{   727304  ,   6945    },
{   734249  ,   6558    },
{   740807  ,   26826   },
{   767633  ,   7315    },
{   774948  ,   6546    },
{   781494  ,   27678   },
{   809172  ,   6885    },
{   816057  ,   7071    },
{   823128  ,   29473   },
{   852601  ,   7225    },
{   859826  ,   6927    },
{   866753  ,   89677   },
{   956430  ,   7828    },
{   964258  ,   6494    },
{   970752  ,   27742   },
{   998494  ,   7345    },
{   1005839 ,   6773    },
{   1012612 ,   27098   },
{   1039710 ,   7014    },
{   1046724 ,   6836    },
{   1053560 ,   24086   },
{   1077646 ,   6824    },
{   1084470 ,   6691    },
{   1091161 ,   23832   },
{   1114993 ,   6739    },
{   1121732 ,   6529    },
{   1128261 ,   24998   },
{   1153259 ,   6732    },
{   1159991 ,   6658    },
{   1166649 ,   82284   },
{   1248933 ,   6678    },
{   1255611 ,   5941    },
{   1261552 ,   27199   },
{   1288751 ,   5961    },
{   1294712 ,   6022    },
{   1300734 ,   27374   },
{   1328108 ,   5873    },
{   1333981 ,   5901    },
{   1339882 ,   29558   },
{   1369440 ,   5897    },
{   1375337 ,   5852    },
{   1381189 ,   29708   },
{   1410897 ,   5867    },
{   1416764 ,   6030    },
{   1422794 ,   33116   },
{   1455910 ,   5742    },
{   1461652 ,   5870    },
{   1467522 ,   89201   },
{   1556723 ,   6607    },
{   1563330 ,   6341    },
{   1569671 ,   31241   },
{   1600912 ,   6243    },
{   1607155 ,   6322    },
{   1613477 ,   31500   },
{   1644977 ,   6128    },
{   1651105 ,   6394    },
{   1657499 ,   29628   },
{   1687127 ,   6095    },
{   1693222 ,   6370    },
{   1699592 ,   21588   },
{   1721180 ,   6153    },
{   1727333 ,   6323    },
{   1733656 ,   21216   },
{   1754872 ,   6204    },
{   1761076 ,   6360    },
{   1767436 ,   99807   },
{   1867243 ,   6669    },
{   1873912 ,   6705    },
{   1880617 ,   22930   },
{   1903547 ,   6717    },
{   1910264 ,   6837    },
{   1917101 ,   22916   },
{   1940017 ,   6817    },
{   1946834 ,   6872    },
{   1953706 ,   23254   },
{   1976960 ,   6857    },
{   1983817 ,   6853    },
{   1990670 ,   23934   },
{   2014604 ,   7221    },
{   2021825 ,   7115    },
{   2028940 ,   25092   },
{   2054032 ,   6744    },
{   2060776 ,   6891    },
{   2067667 ,   99948   },
{   2167615 ,   6974    },
{   2174589 ,   7040    },
{   2181629 ,   23245   },
{   2204874 ,   6833    },
{   2211707 ,   6763    },
{   2218470 ,   23159   },
{   2241629 ,   7011    },
{   2248640 ,   6822    },
{   2255462 ,   24381   },
{   2279843 ,   6732    },
{   2286575 ,   7019    },
{   2293594 ,   23166   },
{   2316760 ,   6871    },
{   2323631 ,   6945    },
{   2330576 ,   23894   },
{   2354470 ,   6692    },
{   2361162 ,   6791    },
{   2367953 ,   99688   },
{   2467641 ,   6932    },
{   2474573 ,   6682    },
{   2481255 ,   23132   },
{   2504387 ,   6727    },
{   2511114 ,   6781    },
{   2517895 ,   23571   },
{   2541466 ,   6759    },
{   2548225 ,   6976    },
{   2555201 ,   23563   },
{   2578764 ,   7086    },
{   2585850 ,   6929    },
{   2592779 ,   23520   },
{   2616299 ,   6956    },
{   2623255 ,   6959    },
{   2630214 ,   24335   },
{   2654549 ,   7192    },
{   2661741 ,   6870    },
{   2668611 ,   99193   },
{   2767804 ,   7294    },
{   2775098 ,   6818    },
{   2781916 ,   22763   },
{   2804679 ,   6699    },
{   2811378 ,   7000    },
{   2818378 ,   22695   },
{   2841073 ,   6588    },
{   2847661 ,   6920    },
{   2854581 ,   23606   },
{   2878187 ,   6875    },
{   2885062 ,   6945    },
{   2892007 ,   22794   },
{   2914801 ,   6942    },
{   2921743 ,   6860    },
{   2928603 ,   26614   },
{   2955217 ,   6705    },
{   2961922 ,   6932    },
{   2968854 ,   100302  },
{   3069156 ,   6854    },
{   3076010 ,   6883    },
{   3082893 ,   23277   },
{   3106170 ,   6864    },
{   3113034 ,   7065    },
{   3120099 ,   23796   },
{   3143895 ,   6786    },
{   3150681 ,   7015    },
{   3157696 ,   22697   },
{   3180393 ,   6835    },
{   3187228 ,   6960    },
{   3194188 ,   22576   },
{   3216764 ,   6939    },
{   3223703 ,   6966    },
{   3230669 ,   24592   },
{   3255261 ,   6873    },
{   3262134 ,   7102    },
{   3269236 ,   100149  },
{   3369385 ,   7439    },
{   3376824 ,   6807    },
{   3383631 ,   23175   },
{   3406806 ,   6984    },
{   3413790 ,   6984    },
{   3420774 ,   23140   },
{   3443914 ,   6885    },
{   3450799 ,   6976    },
{   3457775 ,   23206   },
{   3480981 ,   6918    },
{   3487899 ,   6923    },
{   3494822 ,   23990   },
{   3518812 ,   6961    },
{   3525773 ,   7126    },
{   3532899 ,   22508   },
{   3555407 ,   7043    },
{   3562450 ,   7048    },
{   3569498 ,   101706  },
{   3671204 ,   7227    },
{   3678431 ,   6895    },
{   3685326 ,   22961   },
{   3708287 ,   6745    },
{   3715032 ,   7150    },
{   3722182 ,   22485   },
{   3744667 ,   6765    },
{   3751432 ,   6963    },
{   3758395 ,   22784   },
{   3781179 ,   6852    },
{   3788031 ,   7047    },
{   3795078 ,   23062   },
{   3818140 ,   6949    },
{   3825089 ,   7035    },
{   3832124 ,   23436   },
{   3855560 ,   6905    },
{   3862465 ,   6989    },
{   3869454 ,   102519  },
{   3971973 ,   6616    },
{   3978589 ,   6735    },
{   3985324 ,   22750   },
{   4008074 ,   6911    },
{   4014985 ,   7009    },
{   4021994 ,   22810   },
{   4044804 ,   6767    },
{   4051571 ,   6995    },
{   4058566 ,   22909   },
{   4081475 ,   6781    },
{   4088256 ,   6987    },
{   4095243 ,   22999   },
{   4118242 ,   6903    },
{   4125145 ,   6968    },
{   4132113 ,   23791   },
{   4155904 ,   6911    },
{   4162815 ,   6997    },
{   4169812 ,   102624  },
{   4272436 ,   6745    },
{   4279181 ,   6810    },
{   4285991 ,   22818   },
{   4308809 ,   6802    },
{   4315611 ,   7144    },
{   4322755 ,   23435   },
{   4346190 ,   6785    },
{   4352975 ,   6974    },
{   4359949 ,   22714   },
{   4382663 ,   6857    },
{   4389520 ,   6906    },
{   4396426 ,   22878   },
{   4419304 ,   6896    },
{   4426200 ,   7070    },
{   4433270 ,   22881   },
{   4456151 ,   6930    },
{   4463081 ,   7041    },
{   4470122 ,   101745  },
{   4571867 ,   6475    },
{   4578342 ,   6760    },
{   4585102 ,   22212   },
{   4607314 ,   6750    },
{   4614064 ,   6951    },
{   4621015 ,   23816   },
{   4644831 ,   6578    },
{   4651409 ,   6832    },
{   4658241 ,   22440   },
{   4680681 ,   6827    },
{   4687508 ,   6855    },
{   4694363 ,   22343   },
{   4716706 ,   6855    },
{   4723561 ,   6859    },
{   4730420 ,   26475   },
{   4756895 ,   6613    },
{   4763508 ,   6938    },
{   4770446 ,   90536   },
{   4860982 ,   5790    },
{   4866772 ,   5924    },
{   4872696 ,   24285   },
{   4896981 ,   5824    },
{   4902805 ,   6146    },
{   4908951 ,   25466   },
{   4934417 ,   5842    },
{   4940259 ,   6227    },
{   4946486 ,   27622   },
{   4974108 ,   5987    },
{   4980095 ,   6404    },
{   4986499 ,   28569   },
{   5015068 ,   6059    },
{   5021127 ,   6245    },
{   5027372 ,   31142   },
{   5058514 ,   6237    },
{   5064751 ,   6481    },
{   5071232 ,   68825   },
{   5140057 ,   6230    },
{   5146287 ,   5989    },
{   5152276 ,   33987   },
{   5186263 ,   6256    },
{   5192519 ,   6291    },
{   5198810 ,   35636   },
{   5234446 ,   6374    },
{   5240820 ,   6656    },
{   5247476 ,   33490   },
{   5280966 ,   6797    },
{   5287763 ,   6619    },
{   5294382 ,   27598   },
{   5321980 ,   6407    },
{   5328387 ,   5877    },
{   5334264 ,   25160   },
{   5359424 ,   6128    },
{   5365552 ,   6014    },
{   5371566 ,   82232   },
{   5453798 ,   7608    },
{   5461406 ,   6747    },
{   5468153 ,   26815   },
{   5494968 ,   6942    },
{   5501910 ,   6675    },
{   5508585 ,   27366   },
{   5535951 ,   7022    },
{   5542973 ,   6761    },
{   5549734 ,   26824   },
{   5576558 ,   6950    },
{   5583508 ,   6642    },
{   5590150 ,   26987   },
{   5617137 ,   6602    },
{   5623739 ,   6690    },
{   5630429 ,   27628   },
{   5658057 ,   6879    },
{   5664936 ,   6788    },
{   5671724 ,   81270   },
{   5752994 ,   7305    },
{   5760299 ,   6655    },
{   5766954 ,   25476   },
{   5792430 ,   6777    },
{   5799207 ,   6617    },
{   5805824 ,   26622   },
{   5832446 ,   6858    },
{   5839304 ,   6816    },
{   5846120 ,   26229   },
{   5872349 ,   6892    },
{   5879241 ,   6670    },
{   5885911 ,   29352   },
{   5915263 ,   7096    },
{   5922359 ,   6917    },
{   5929276 ,   28723   },
{   5957999 ,   7097    },
{   5965096 ,   6813    },
{   5971909 ,   75798   },
{   6047707 ,   7265    },
{   6054972 ,   6379    },
{   6061351 ,   26810   },
{   6088161 ,   6676    },
{   6094837 ,   6522    },
{   6101359 ,   30031   },
{   6131390 ,   7135    },
{   6138525 ,   7041    },
{   6145566 ,   29996   },
{   6175562 ,   7542    },
{   6183104 ,   6833    },
{   6189937 ,   28183   },
{   6218120 ,   7111    },
{   6225231 ,   6739    },
{   6231970 ,   26901   },
{   6258871 ,   6772    },
{   6265643 ,   6560    },
{   6272203 ,   71443   },
{   6343646 ,   6976    },
{   6350622 ,   6314    },
{   6356936 ,   27461   },
{   6384397 ,   6725    },
{   6391122 ,   6701    },
{   6397823 ,   30542   },
{   6428365 ,   8081    },
{   6436446 ,   8205    },
{   6444651 ,   29544   },
{   6474195 ,   7484    },
{   6481679 ,   6711    },
{   6488390 ,   27181   },
{   6515571 ,   6983    },
{   6522554 ,   6513    },
{   6529067 ,   29786   },
{   6558853 ,   6970    },
{   6565823 ,   6622    },
{   6572445 ,   59975   },
{   6632420 ,   6891    },
{   6639311 ,   6636    },
{   6645947 ,   32041   },
{   6677988 ,   9168    },
{   6687156 ,   8519    },
{   6695675 ,   31532   },
{   6727207 ,   9461    },
{   6736668 ,   8044    },
{   6744712 ,   28475   },
{   6773187 ,   8076    },
{   6781263 ,   7551    },
{   6788814 ,   28052   },
{   6816866 ,   7813    },
{   6824679 ,   7240    },
{   6831919 ,   26958   },
{   6858877 ,   7351    },
{   6866228 ,   6459    },
{   6872687 ,   69917   },
{   6942604 ,   7782    },
{   6950386 ,   7110    },
{   6957496 ,   29541   },
{   6987037 ,   7828    },
{   6994865 ,   7824    },
{   7002689 ,   29013   },
{   7031702 ,   7544    },
{   7039246 ,   6775    },
{   7046021 ,   29453   },
{   7075474 ,   7590    },
{   7083064 ,   6598    },
{   7089662 ,   28752   },
{   7118414 ,   7208    },
{   7125622 ,   6779    },
{   7132401 ,   27278   },
{   7159679 ,   7024    },
{   7166703 ,   6324    },
{   7173027 ,   70235   },
{   7243262 ,   7222    },
{   7250484 ,   6611    },
{   7257095 ,   26636   },
{   7283731 ,   6827    },
{   7290558 ,   6675    },
{   7297233 ,   28658   },
{   7325891 ,   7610    },
{   7333501 ,   7053    },
{   7340554 ,   30720   },
{   7371274 ,   7247    },
{   7378521 ,   6454    },
{   7384975 ,   29302   },
{   7414277 ,   7393    },
{   7421670 ,   6887    },
{   7428557 ,   29756   },
{   7458313 ,   7582    },
{   7465895 ,   7342    },
{   7473237 ,   70157   },
{   7543394 ,   9344    },
{   7552738 ,   8087    },
{   7560825 ,   32004   },
{   7592829 ,   9326    },
{   7602155 ,   8293    },
{   7610448 ,   27362   },
{   7637810 ,   7381    },
{   7645191 ,   6656    },
{   7651847 ,   27273   },
{   7679120 ,   7040    },
{   7686160 ,   6543    },
{   7692703 ,   27179   },
{   7719882 ,   6877    },
{   7726759 ,   6694    },
{   7733453 ,   26870   },
{   7760323 ,   6935    },
{   7767258 ,   6605    },
{   7773863 ,   73963   },
{   7847826 ,   6765    },
{   7854591 ,   6090    },
{   7860681 ,   24533   },
{   7885214 ,   6343    },
{   7891557 ,   6251    },
{   7897808 ,   23627   },
{   7921435 ,   6274    },
{   7927709 ,   6176    },
{   7933885 ,   28919   },
{   7962804 ,   6153    },
{   7968957 ,   6258    },
{   7975215 ,   34814   },
{   8010029 ,   6692    },
{   8016721 ,   6326    },
{   8023047 ,   36966   },
{   8060013 ,   7348    },
{   8067361 ,   6990    },
{   8074351 ,   55007   },
{   8129358 ,   6910    },
{   8136268 ,   6395    },
{   8142663 ,   29785   },
{   8172448 ,   7621    },
{   8180069 ,   6673    },
{   8186742 ,   31260   },
{   8218002 ,   9120    },
{   8227122 ,   8066    },
{   8235188 ,   31137   },
{   8266325 ,   9114    },
{   8275439 ,   7604    },
{   8283043 ,   30061   },
{   8313104 ,   8545    },
{   8321649 ,   7393    },
{   8329042 ,   30298   }

#endif
};



#define FRAME_NUM   500

static unsigned char Tmp_data[256*1024];

struct Frame
{
    unsigned char start_code[4];
    unsigned char data[0];
};


int split_frame(FILE *input_file)
{
    FILE *output_file;
    char file_name[32];
    int i, size = 0;
    struct Frame *p_frame = NULL;

    if (!input_file || !output_file)
    {
        return -1;
    }

    for (i=0; i<FRAME_NUM; i++)
    {
        //input
        fseek(input_file, frame_info[i][POS], SEEK_SET);
        size = fread(Tmp_data, 1, frame_info[i][SIZE], input_file);
        if (size < frame_info[i][SIZE])
        {
            printf("Read EOF @0x%x!\n", ftell(input_file));
            return -2;
        }

        p_frame = (struct Frame *)Tmp_data;
        if ((p_frame->start_code[0] != 0x00 ||
            p_frame->start_code[1] != 0x00 ||
            p_frame->start_code[2] != 0x00 ||
            p_frame->start_code[3] != 0x01) &&
            (p_frame->start_code[0] != 0x00 ||
            p_frame->start_code[1] != 0x00 ||
            p_frame->start_code[2] != 0x01))
        {
            printf("start code error @0x%x!\n", ftell(input_file));
            //fseek(input_file, -187L, SEEK_CUR);
            break;
        }

        sprintf(file_name, "%06d.es", i);
        output_file = fopen(file_name, "wb");
        if (output_file == NULL)
        {
            printf("Open %s error!\n", file_name);
            return -1;
        }

        // output
        if (fwrite(Tmp_data, 1, size, output_file) != size)
        {
            printf("Write output_file %s error!\n", file_name);
            return -1;
        }

        fclose(output_file);
    }
}

int main(int argc, char **argv) 
{
    FILE *input_file;
    
    if (argc < 2)
    {
        printf("Usage:\n");
        printf("\t%s [input_file]\n", argv[0]);
        return -1;
    }
    
    input_file = fopen(argv[1], "rb");
    if (input_file == NULL)
    {
        printf("Open %s error!\n", argv[1]);
        return -1;
    }

    split_frame(input_file);

    fclose(input_file);
    
    return 0;
}
    